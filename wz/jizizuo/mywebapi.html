<!DOCTYPE html><html lang=en><head><meta charset=utf-8 /><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1" /><meta name=viewport content="width=device-width,initial-scale=1.0,user-scalable=no" /><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png /><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png /><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png /><link rel=manifest href=/site.webmanifest /><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5 /><meta name=msapplication-TileColor content=#da532c /><meta name=theme-color content=#ffffff /><title>文章 | Mirror Space</title><link href=/mirrorui/mirrorui.css rel=stylesheet /><link href=/asset/css/blog.css rel=stylesheet /></head><body><div class=layout><div class=layout-part1><a class="mainmenu-onoff d-block d-md-none" onclick=mainmenuonoff()>Ω</a><div id=mainmenubox class="mainmenu d-none d-md-block"><div class=logobox> <img src=/asset/img/logo.jpg class=logoimg /></div><h3 class=pd-5>Mirror Space</h3><hr class=line /><a class=mainmenu-link href=/index.html>Home</a> <a class=mainmenu-link href=/about.html>About</a> <a class=mainmenu-link href=/projectinfo.html>Info</a><div class=theme id=themebox> <a class=mainmenu-btn onclick=changetheme(1)>白天sun</a> <a class=mainmenu-btn onclick=changetheme(2)>夜晚moon</a><br /> <a class=mainmenu-btn onclick=changefontsize(14)>A</a> <a class=mainmenu-btn onclick=changefontsize(16)>AA</a> <a class=mainmenu-btn onclick=changefontsize(20)>AAA</a></div></div><script src=/asset/js/mainmenu.js></script></div><div class=layout-part2><div class=wz-page><div><div id=article_headerbox></div><a onclick=window.history.back() class="btn link danger">返回上页</a><hr class=line /></div><script src=/asset/js/article.js></script><script>(()=>{let f=window.location.pathname,u=f.split("/"),e="article_"+u[2],t=JSON.parse(window.sessionStorage.getItem(e)),i=u[3].replace(".html",""),n={};n.t=t[i][0];n.d=t[i][1];n.a=t[i][2];let r=`<h1 class="text-center">${n.t}</h1>`;r+=`<h5>作者:&emsp;<span></span>${n.a}</h5>`;r+=`<h5>日期:&emsp;<span></span>${n.d}</h5>`;let o=window.document.querySelector("#article_headerbox");o.innerHTML=r})()</script><p>基于asp.net提供的IHttpHandler接口,自定义的一个webapi框架,实现IHttpHandler接口完成处理请求,映射到处理类.较早就做出来了,今天整理了一下,独立成一个项目.</p><p>目的在于尽量减少使用和部署复杂度.只需要建一个类库项目,实现两个接口就能支持web请求了.</p><p>很早在做这个东西时参考了很多网上的博客,主要是要理解asp.net的管道处理逻辑.这个是在请求到来后,暴露的一系列方法,注册这些方法就能自定义处理过程.</p><p>当时做这个东西主要是因为自带的框架如webform,asp.net mvc,web api,虽然便利,但也有很多东西不必要的.为了精减,至少做一个类似一般处理程序的这种东西就行.</p><p><a href=https://www.cnblogs.com/fish-li/ target=_blank>https://www.cnblogs.com/fish-li/</a> 这个博客的帮助最大,讲得最为清晰.</p><p>想起最早先使用perl做cgi时,就是处理程序了.总结一下,做一个能处理web请求的程序.要解决三个问题.监听,匹配,处理.</p><p>监听的问题交给IIS了.匹配和处理主要是通过IHttpHandler和IHttpHandlerFactory两个接口.这两个接口是asp.net框架提供的.事件顺序大概是第11个事件和第7个事件</p><p>匹配主要是分析请求url,将它映射到具体的处理类.实例化这个类并且调用方法就完成处理.这一系列的逻辑仍然是基于asp.net管道事件的.</p><p>源码 <a href=https://github.com/mirrortom/MyWebApi target=_blank>https://github.com/mirrortom/MyWebApi</a></p><p>需要运行在IIS中,程序池是.net framework4.0</p></div></div></div></body></html>