<!DOCTYPE html><html lang=en><head><meta charset=utf-8 /><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1" /><meta name=viewport content="width=device-width,initial-scale=1.0,user-scalable=no" /><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png /><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png /><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png /><link rel=manifest href=/site.webmanifest /><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5 /><meta name=msapplication-TileColor content=#da532c /><meta name=theme-color content=#ffffff /><title>xUnit | Mirror Space</title><link href=/mirrorui/mirrorui.css rel=stylesheet /><link href=/asset/css/blog.css rel=stylesheet /></head><body><div class=layout><div class=layout-part1><a class="mainmenu-onoff d-block d-md-none" onclick=mainmenuonoff()>Ω</a><div id=mainmenubox class="mainmenu d-none d-md-block"><div class=logobox> <img src=/asset/img/logo.jpg class=logoimg /></div><h3 class=pd-5>Mirror Space</h3><hr class=line /><a class=mainmenu-link href=/index.html>Home</a> <a class=mainmenu-link href=/about.html>About</a> <a class=mainmenu-link href=/projectinfo.html>Info</a><div class=theme id=themebox> <a class=mainmenu-btn onclick=changetheme(1)>白天sun</a> <a class=mainmenu-btn onclick=changetheme(2)>夜晚moon</a><br /> <a class=mainmenu-btn onclick=changefontsize(14)>A</a> <a class=mainmenu-btn onclick=changefontsize(16)>AA</a> <a class=mainmenu-btn onclick=changefontsize(20)>AAA</a></div></div><script src=/asset/js/mainmenu.js></script></div><div class=layout-part2><div class=wz-page><div><div id=article_headerbox></div><a onclick=window.history.back() class="btn link danger">返回上页</a><hr class=line /></div><script src=/asset/js/article.js></script><script>(()=>{let f=window.location.pathname,u=f.split("/"),e="article_"+u[2],t=JSON.parse(window.sessionStorage.getItem(e)),i=u[3].replace(".html",""),n={};n.t=t[i][0];n.d=t[i][1];n.a=t[i][2];let r=`<h1 class="text-center">${n.t}</h1>`;r+=`<h5>作者:&emsp;<span></span>${n.a}</h5>`;r+=`<h5>日期:&emsp;<span></span>${n.d}</h5>`;let o=window.document.querySelector("#article_headerbox");o.innerHTML=r})()</script><p>单元测试对于做出一个可靠的软件是必要的.</p><p>c#的单元测试有nunit库,对于VS2017,这个已经集成了.</p><p>在vs2017里新建项目,选择[测试],有三种选择: 1. MSTest测试项目(.NET Core) 2. xUnit测试项目(.NET Core) 3. 单元测试项目(.NET Framework)</p><p>选择xUnit测试项目(.NET Core)这个,建立项目.</p><p>单元测试本身是一个项目,引用要测试的项目后,就可以测试了.以前做一些简单的测试时,建立一个控制台程序,引用要测试的类,打印测试结果到屏幕.</p><p>xUnit单元测试库的做法更加正规,有丰富的工具方法可以使用,测试更方便些.</p><p class=article-title>引用和vs工具</p><p>第一次建立xUnit项目时,失败了,nuget包的依赖问题,最后联网重新添加nuget包,解决.以下是包引用</p><ul class=list><li>NuGet<ul class=list><li>Microsoft.NET.Test.Sdk(15.80)</li><li>xunit(2.3.1)</li><li>xunit.runner.visualstudio(2.4.1)</li></ul></li><li>SDK<ul class=list><li>Microsoft.NETCore.App(2.1)</li></ul></li></ul><br /><p>vs2017相关工具菜单:</p><p>[测试]→[窗口]→[测试资源管理器] 这是测试结果查看窗口</p><p>[测试]→[参数设置]→[默认处理器体系结构] x86或者x64选项有可能导致测试程序运行失败</p><p>vs2017测试插件必须开启</p><p>[工具]→[扩展和更新]→Microsoft Visual Studio 测试平台 这个插件需要开启,否则测试项目运行失败</p><p class=article-title>测试</p><p>最简单测试示例,例如有一个项目proj1,有个类User,有方法User.GetLastName(),返回值长度预期为1.</p><p>那么先添加项目引用proj1,到xUnit项目添加测试类UnitTest1,添加方法UserGetLastNameTest(),贴特性[Fact]</p>
  <pre class=bg-gray>
    public class UnitTest1
    {
        [Fact]
        public void UserGetLastNameTest()
        {
            User user = new User();
            int lastNameLen = user.GetLastName().Length;
            // 预期结果是1,如果是1测试通过,否则测试就不通过
            Assert.Equal(1, lastNameLen);
        }
    }

</pre><br /><p>在UserGetLastNameTest()代码里右击鼠标,菜单中选择 [运行测试(T)].</p><p>测试项目开始运行,如果被测试项目proj1没有编译,会自动编译.</p><p>在 [测试资源管理器] 窗口中会显示所有测试方法,成功和失败结果.点击按钮可以运行所有测试,也可以单独运行一个测试.</p><p class=article-title>应用</p><p>对于代码量大,逻辑深长的软件项目必须做单元测试,以便提高测试效率.难以想象为了测试一个方法,要跑一个全流程.</p><p>单元测试可以只针对怀疑出错的地方测试.</p><p>对于一些不确定结果的API,也可以用单元测试来尝试.</p><p>虽然单元测试也要写程序,但是时间成本要比人工测试小多了,也比打日志测试的办法好很多.</p></div><hr class=line /></div></div></body></html>