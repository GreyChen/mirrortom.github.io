<!DOCTYPE html><html lang=en><head><meta charset=utf-8 /><meta http-equiv=X-UA-Compatible content="IE=edge" /><meta name=viewport content="width=device-width,initial-scale=1.0" /><link href=/mirrorui/mirrorui.css rel=stylesheet /><title>fill | canvas文档整理 | Mirror Space</title><style>.page{display:grid;grid-template-columns:210px auto}.mainmenubox{position:sticky;top:0;width:94%;max-height:100vh;overflow-x:hidden;overflow-y:auto}</style></head><body><div class=page><div class=mainmenubox><nav class=sidemenu-box id=main_menubox style=max-width:200px><ul class=sidemenu-group><li><span class=sidemenu-label>canvas<i class=sidemenu-arrdown></i></span></li><li><a class=sidemenu-item href=ckdoc.html>参考文档</a></li><li><a class=sidemenu-item href=index.html>CanvasRenderingContext2D</a></li><li><a class=sidemenu-item href=todataurl.html>toDataURL</a></li><li><a class=sidemenu-item href=toblob.html>toBlob</a></li></ul><ul class=sidemenu-group><li><span class=sidemenu-label>属性<i class=sidemenu-arrdown></i></span></li><li><a class=sidemenu-item href=canvas.html title=canvas>canvas</a></li><li><a class=sidemenu-item href=currenttransform.html title=currentTransform>currentTransform</a></li><li><a class=sidemenu-item href=direction.html title=direction>direction</a></li><li><a class=sidemenu-item href=fillstyle.html title=fillStyle>fillStyle</a></li><li><a class=sidemenu-item href=filter.html title=filter>filter</a></li><li><a class=sidemenu-item href=font.html title=font>font</a></li><li><a class=sidemenu-item href=globalalpha.html title=globalAlpha>globalAlpha</a></li><li><a class=sidemenu-item href=globalcompositeoperation.html title=globalCompositeOperation>globalCompositeOperation</a></li><li><a class=sidemenu-item href=imagesmoothingenabled.html title=imageSmoothingEnabled>imageSmoothingEnabled</a></li><li><a class=sidemenu-item href=imagesmoothingquality.html title=imageSmoothingQuality>imageSmoothingQuality</a></li><li><a class=sidemenu-item href=linecap.html title=lineCap>lineCap</a></li><li><a class=sidemenu-item href=linedashoffset.html title=lineDashOffset>lineDashOffset</a></li><li><a class=sidemenu-item href=linejoin.html title=lineJoin>lineJoin</a></li><li><a class=sidemenu-item href=linewidth.html title=lineWidth>lineWidth</a></li><li><a class=sidemenu-item href=miterlimit.html title=miterLimit>miterLimit</a></li><li><a class=sidemenu-item href=shadowblur.html title=shadowBlur>shadowBlur</a></li><li><a class=sidemenu-item href=shadowcolor.html title=shadowColor>shadowColor</a></li><li><a class=sidemenu-item href=shadowoffsetx.html title=shadowOffsetX>shadowOffsetX</a></li><li><a class=sidemenu-item href=shadowoffsety.html title=shadowOffsetY>shadowOffsetY</a></li><li><a class=sidemenu-item href=strokestyle.html title=strokeStyle>strokeStyle</a></li><li><a class=sidemenu-item href=textalign.html title=textAlign>textAlign</a></li><li><a class=sidemenu-item href=textbaseline.html title=textBaseline>textBaseline</a></li></ul><ul class=sidemenu-group><li><span class=sidemenu-label>方法<i class=sidemenu-arrdown></i></span></li><li><a class=sidemenu-item href=addhitregion.html title=addHitRegion>addHitRegion()</a></li><li><a class=sidemenu-item href=arc.html title=arc>arc()</a></li><li><a class=sidemenu-item href=arcto.html title=arcTo>arcTo()</a></li><li><a class=sidemenu-item href=beginpath.html title=beginPath>beginPath()</a></li><li><a class=sidemenu-item href=beziercurveto.html title=bezierCurveTo>bezierCurveTo()</a></li><li><a class=sidemenu-item href=clearhitregions.html title=clearHitRegions>clearHitRegions()</a></li><li><a class=sidemenu-item href=clearrect.html title=clearRect>clearRect()</a></li><li><a class=sidemenu-item href=clip.html title=clip>clip()</a></li><li><a class=sidemenu-item href=closepath.html title=closePath>closePath()</a></li><li><a class=sidemenu-item href=createimagedata.html title=createImageData>createImageData()</a></li><li><a class=sidemenu-item href=createlineargradient.html title=createLinearGradient>createLinearGradient()</a></li><li><a class=sidemenu-item href=createpattern.html title=createPattern>createPattern()</a></li><li><a class=sidemenu-item href=createradialgradient.html title=createRadialGradient>createRadialGradient()</a></li><li><a class=sidemenu-item href=drawfocusifneeded.html title=drawFocusIfNeeded>drawFocusIfNeeded()</a></li><li><a class=sidemenu-item href=drawimage.html title=drawImage>drawImage()</a></li><li><a class=sidemenu-item href=drawwidgetasonscreen.html title=drawWidgetAsOnScreen>drawWidgetAsOnScreen()</a></li><li><a class=sidemenu-item href=drawwindow.html title=drawWindow>drawWindow()</a></li><li><a class=sidemenu-item href=ellipse.html title=ellipse>ellipse()</a></li><li><a class=sidemenu-item href=fill.html title=fill>fill()</a></li><li><a class=sidemenu-item href=fillrect.html title=fillRect>fillRect()</a></li><li><a class=sidemenu-item href=filltext.html title=fillText>fillText()</a></li><li><a class=sidemenu-item href=getimagedata.html title=getImageData>getImageData()</a></li><li><a class=sidemenu-item href=getlinedash.html title=getLineDash>getLineDash()</a></li><li><a class=sidemenu-item href=ispointinpath.html title=isPointInPath>isPointInPath()</a></li><li><a class=sidemenu-item href=ispointinstroke.html title=isPointInStroke>isPointInStroke()</a></li><li><a class=sidemenu-item href=lineto.html title=lineTo>lineTo()</a></li><li><a class=sidemenu-item href=measuretext.html title=measureText>measureText()</a></li><li><a class=sidemenu-item href=moveto.html title=moveTo>moveTo()</a></li><li><a class=sidemenu-item href=putimagedata.html title=putImageData>putImageData()</a></li><li><a class=sidemenu-item href=quadraticcurveto.html title=quadraticCurveTo>quadraticCurveTo()</a></li><li><a class=sidemenu-item href=rect.html title=rect>rect()</a></li><li><a class=sidemenu-item href=removehitregion.html title=removeHitRegion>removeHitRegion()</a></li><li><a class=sidemenu-item href=resettransform.html title=resetTransform>resetTransform()</a></li><li><a class=sidemenu-item href=restore.html title=restore>restore()</a></li><li><a class=sidemenu-item href=rotate.html title=rotate>rotate()</a></li><li><a class=sidemenu-item href=save.html title=save>save()</a></li><li><a class=sidemenu-item href=scale.html title=scale>scale()</a></li><li><a class=sidemenu-item href=scrollpathintoview.html title=scrollPathIntoView>scrollPathIntoView()</a></li><li><a class=sidemenu-item href=setlinedash.html title=setLineDash>setLineDash()</a></li><li><a class=sidemenu-item href=settransform.html title=setTransform>setTransform()</a></li><li><a class=sidemenu-item href=stroke.html title=stroke>stroke()</a></li><li><a class=sidemenu-item href=strokerect.html title=strokeRect>strokeRect()</a></li><li><a class=sidemenu-item href=stroketext.html title=strokeText>strokeText()</a></li><li><a class=sidemenu-item href=transform.html title=transform>transform()</a></li><li><a class=sidemenu-item href=translate.html title=translate>translate()</a></li></ul></nav><script>function menuinit(){let i=document.getElementById("main_menubox"),n="sidemenu-arrdown",t="sidemenu-arrleft";i.querySelectorAll(".sidemenu-label").forEach(i=>{i.onclick=()=>{let r=i.parentNode.querySelector(`.${n},.${t}`);r.classList.contains(n)?(r.classList.remove(n),r.classList.add(t),i.parentNode.parentNode.classList.add("sidemenu-group-close")):(r.classList.add(n),r.classList.remove(t),i.parentNode.parentNode.classList.remove("sidemenu-group-close"))}})}function currentMenu(){let t=window.location.pathname,r=t.substr(t.lastIndexOf("/")+1),u="#main_menubox [href='"+r+"']",n=document.querySelector(u);n.classList.add("active");n.classList.add("bg-grayse");let i=document.querySelector("#main_menubox").parentElement;i.scrollTo(0,n.offsetTop-i.clientHeight/2)}menuinit();currentMenu()</script></div><div class=pd-20><h2>fill()</h2><p>根据当前的填充样式，填充当前或已存在的路径的方法。采取非零环绕或者奇偶环绕规则。</p>
<pre class="bg-gray pd-tb-10">
  ctx.fill()
  ctx.fill(fillRule)
  ctx.fill(path, fillRule)
</pre><br /><h4>参数</h4><p><label class="label danger">fillRule</label> <small>Number</small> 一种算法，决定点是在路径内还是在路径外。 "nonzero": 非零环绕规则,默认的规则 "evenodd": 奇偶环绕规则</p><p><label class="label danger">path</label> <small>Number</small> 需要填充的Path2D 路径</p><br /><h4>测验</h4><p>设定三个点,然后fill(),效果如下.可见填充了路径所包围的面积,即使路径没有闭合也会当做闭合路径填充</p><canvas id=canvas1></canvas><h3>evenodd</h3><p>奇偶环绕规则,以下两个5角星对比,左边是默认规则fill(),右边是fill("evenodd")</p><canvas id=canvas2></canvas><p>6角星8角星,填充参数为"evenodd".可见中间没有填充.</p><canvas id=canvas3></canvas><p>下图两个同心圆,采用非零填充.这里有个关键点,两个圆的路径走向是相反的,外圈是顺时针,内圈是逆时针.根据非零规则,从内圈范围内发出的射线会与</p><p>两圆路径相交两次,而且一次是顺时针路径相交,一次是逆时针路径相交,记数结果为0.故内圈不属于路径范围,所以内圈不会被填充.</p><p>但是内圈里有个矩形被填充了,还是根据非零规则,从矩形范围内发出的射线会与路径有三次相交,两次是与内外圈的圆相交,结果为0,一次与矩形的边相交</p><p>结果为1(或-1),所以在路径范围内,故被填充了</p><canvas id=canvas6></canvas><p>如果采用两个矩形,能否达到上述效果呢.当然可以,不过如果是使用<a href=rect.html>rect()</a>画的矩形则不行,rect()只按顺时针画矩形</p><p>而要达到上面效果,也需要内外矩形走向相反.所以内层的矩形要手动画一个逆时针走向的才行.</p><p>&lt;&lt;H5核心技术图形动画与游戏开发(David Geary)>> (68页)</p><canvas id=canvas7></canvas><h3>path</h3><p>需要填充的Path2D 路径,暂无测验</p><h3>非零环绕规则</h3><p>平面内任何一点p做射线,射线长度要超过多边形范围,射线与多边形相交(不碰到顶点),如果顺时针走向的边与射线相交则</p><p>记+1(记数器以0开始),逆时针走向的边与射线相交记-1.最终计算结果为0时,p在多边形外,非0时在多边形内</p><p>举例说明,一个5角星,边的走向顺序规定为(A~B)(B~C)(C~D)(D~E)(E~A),图中绿色箭头指向</p><p>有一点p的射线,与边(A~B)(D~E)相交,从方向上看,这两边都是逆时针走向的,所以最终记为-2</p><p>由于-2!=0,所以p点是这5角星内的点.所以fill()方法会填充整个5角星</p><canvas id=canvas4></canvas><h3>奇偶环绕规则</h3><p>平面内任何一点p做射线,与多边形相交(不碰到顶点),如果交点为奇数,则p在其内,反之在其外</p><p>这条规则简单一些,就是看交点的奇偶数.下图p射线与5角星有两个交点,是偶数.所以p不在其内.</p><p>所以填充fill("evenodd")不包含这个区域</p><canvas id=canvas5></canvas><script src=/jslib/cavlib.js></script><script>function test7(){let t=cavlib("canvas7").style(),n=t.ctx;n.rect(30,30,200,80);n.moveTo(50,50);n.lineTo(50,90);n.lineTo(210,90);n.lineTo(210,50);n.fill()}function test6(){let i=cavlib("canvas6").style(),n=i.ctx,t={x:160,y:75};n.lineWidth=3;n.arc(t.x,t.y,60,0,Math.PI*2);n.arc(t.x,t.y,45,0,Math.PI*2,!0);n.rect(t.x-20,t.y-20,40,40);n.strokeStyle="brown";n.stroke();n.fillStyle="gray";n.fill()}function test5(){let u=cavlib("canvas5").style(),n=u.ctx,i=65,t={x:125,y:78};n.font="18px serial";n.save();n.translate(t.x,t.y);n.moveTo(0,-i);for(var r=0;r<5;r++)n.rotate(-Math.PI*4/5),n.lineTo(0,-i);n.fillStyle="skyblue";n.fill("evenodd");n.stroke();n.restore();n.save();n.translate(t.x,t.y);n.beginPath();n.arc(0,0,4,0,Math.PI*2);n.moveTo(0,0);n.lineTo(100,-20);n.fillText("p点射线",108,-20);n.strokeStyle="red";n.stroke();n.restore()}function test4(){var t;let u=cavlib("canvas4").style(),n=u.ctx,i=65,r={x:125,y:78};for(n.font="18px serial",n.save(),n.translate(r.x,r.y),n.moveTo(0,-i),t=0;t<5;t++)n.rotate(-Math.PI*4/5),n.lineTo(0,-i),n.fillText(["A","B","C","D","E"][t],0,-i);for(n.fillStyle="skyblue",n.fill(),n.stroke(),n.restore(),n.save(),n.beginPath(),n.fillStyle="green",n.translate(r.x,r.y),t=0;t<5;t++)n.rotate(-Math.PI*2/5),n.moveTo(0,-i/3+8),n.lineTo(-8,-i/3),n.lineTo(0,-i/3-8),n.fill();n.restore();n.save();n.translate(r.x,r.y);n.beginPath();n.arc(0,0,4,0,Math.PI*2);n.moveTo(0,0);n.lineTo(100,-20);n.fillText("p点射线",108,-20);n.strokeStyle="red";n.stroke();n.restore()}function test3(){var t;let r=cavlib("canvas3").style(),n=r.ctx,i=60;for(n.save(),n.translate(65,70),n.moveTo(0,-i),t=0;t<3;t++)n.rotate(-Math.PI*2/3),n.lineTo(0,-i);for(n.stroke(),n.restore(),n.save(),n.translate(65,70),n.moveTo(0,i),t=0;t<3;t++)n.rotate(-Math.PI*2/3),n.lineTo(0,i);for(n.stroke(),n.fill("evenodd"),n.restore(),n.save(),n.beginPath(),n.translate(200,70),n.moveTo(0,-i),t=0;t<4;t++)n.rotate(-Math.PI/2),n.lineTo(0,-i);for(n.stroke(),n.restore(),n.save(),n.translate(200,70),n.rotate(-Math.PI/4),n.moveTo(0,i),t=0;t<4;t++)n.rotate(-Math.PI/2),n.lineTo(0,i);n.stroke();n.fill("evenodd");n.restore()}function test2(){var t;let r=cavlib("canvas2").style(),n=r.ctx,i=60;for(n.save(),n.translate(65,70),n.moveTo(0,-i),t=0;t<5;t++)n.rotate(-Math.PI*4/5),n.lineTo(0,-i);for(n.fill(),n.restore(),n.save(),n.translate(200,70),n.moveTo(0,-i),t=0;t<5;t++)n.rotate(-Math.PI*4/5),n.lineTo(0,-i);n.fill("evenodd");n.restore()}function test1(){let t=cavlib("canvas1").style(),n=t.ctx;n.beginPath();n.moveTo(20,30);n.lineTo(220,60);n.lineTo(60,140);n.fill()}test1();test2();test3();test4();test5();test6();test7()</script></div></div></body></html>