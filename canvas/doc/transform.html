<!DOCTYPE html><html lang=en><head><meta charset=utf-8 /><meta http-equiv=X-UA-Compatible content="IE=edge" /><meta name=viewport content="width=device-width,initial-scale=1.0" /><link href=/mirrorui/mirrorui.css rel=stylesheet /><title>transform | canvas文档整理 | Mirror Space</title><style>.mainmenubox{position:sticky;top:0;max-height:90vh;overflow:hidden;overflow-y:auto}</style></head><body><p>文档参考1<a href=https://www.canvasapi.cn target=_blank>https://www.canvasapi.cn</a>  文档参考2<a href=https://developer.mozilla.org/zh-CN/docs/Web/API/Canvas_API/Tutorial target=_blank>https://developer.mozilla.org/zh-CN/docs/Web/API/Canvas_API/Tutorial</a> 文档参考3 &lt;&lt;H5核心技术图形动画与游戏开发(David Geary)>></p><hr class=line /><div class=grids><div class="grid-2 mainmenubox"><nav class=sidemenu-box id=main_menubox style=max-width:200px><ul class=sidemenu-group><li><span class=sidemenu-label>canvas<i class=sidemenu-arrdown></i></span></li><li><a class=sidemenu-item href=index.html>CanvasRenderingContext2D</a></li><li><a class=sidemenu-item href=todataurl.html>toDataURL</a></li><li><a class=sidemenu-item href=toblob.html>toBlob</a></li></ul><ul class=sidemenu-group><li><span class=sidemenu-label>属性<i class=sidemenu-arrdown></i></span></li><li><a class=sidemenu-item href=canvas.html title=canvas>canvas</a></li><li><a class=sidemenu-item href=currenttransform.html title=currentTransform>currentTransform</a></li><li><a class=sidemenu-item href=direction.html title=direction>direction</a></li><li><a class=sidemenu-item href=fillstyle.html title=fillStyle>fillStyle</a></li><li><a class=sidemenu-item href=filter.html title=filter>filter</a></li><li><a class=sidemenu-item href=font.html title=font>font</a></li><li><a class=sidemenu-item href=globalalpha.html title=globalAlpha>globalAlpha</a></li><li><a class=sidemenu-item href=globalcompositeoperation.html title=globalCompositeOperation>globalCompositeOperation</a></li><li><a class=sidemenu-item href=imagesmoothingenabled.html title=imageSmoothingEnabled>imageSmoothingEnabled</a></li><li><a class=sidemenu-item href=imagesmoothingquality.html title=imageSmoothingQuality>imageSmoothingQuality</a></li><li><a class=sidemenu-item href=linecap.html title=lineCap>lineCap</a></li><li><a class=sidemenu-item href=linedashoffset.html title=lineDashOffset>lineDashOffset</a></li><li><a class=sidemenu-item href=linejoin.html title=lineJoin>lineJoin</a></li><li><a class=sidemenu-item href=linewidth.html title=lineWidth>lineWidth</a></li><li><a class=sidemenu-item href=miterlimit.html title=miterLimit>miterLimit</a></li><li><a class=sidemenu-item href=shadowblur.html title=shadowBlur>shadowBlur</a></li><li><a class=sidemenu-item href=shadowcolor.html title=shadowColor>shadowColor</a></li><li><a class=sidemenu-item href=shadowoffsetx.html title=shadowOffsetX>shadowOffsetX</a></li><li><a class=sidemenu-item href=shadowoffsety.html title=shadowOffsetY>shadowOffsetY</a></li><li><a class=sidemenu-item href=strokestyle.html title=strokeStyle>strokeStyle</a></li><li><a class=sidemenu-item href=textalign.html title=textAlign>textAlign</a></li><li><a class=sidemenu-item href=textbaseline.html title=textBaseline>textBaseline</a></li></ul><ul class=sidemenu-group><li><span class=sidemenu-label>方法<i class=sidemenu-arrdown></i></span></li><li><a class=sidemenu-item href=addhitregion.html title=addHitRegion>addHitRegion()</a></li><li><a class=sidemenu-item href=arc.html title=arc>arc()</a></li><li><a class=sidemenu-item href=arcto.html title=arcTo>arcTo()</a></li><li><a class=sidemenu-item href=beginpath.html title=beginPath>beginPath()</a></li><li><a class=sidemenu-item href=beziercurveto.html title=bezierCurveTo>bezierCurveTo()</a></li><li><a class=sidemenu-item href=clearhitregions.html title=clearHitRegions>clearHitRegions()</a></li><li><a class=sidemenu-item href=clearrect.html title=clearRect>clearRect()</a></li><li><a class=sidemenu-item href=clip.html title=clip>clip()</a></li><li><a class=sidemenu-item href=closepath.html title=closePath>closePath()</a></li><li><a class=sidemenu-item href=createimagedata.html title=createImageData>createImageData()</a></li><li><a class=sidemenu-item href=createlineargradient.html title=createLinearGradient>createLinearGradient()</a></li><li><a class=sidemenu-item href=createpattern.html title=createPattern>createPattern()</a></li><li><a class=sidemenu-item href=createradialgradient.html title=createRadialGradient>createRadialGradient()</a></li><li><a class=sidemenu-item href=drawfocusifneeded.html title=drawFocusIfNeeded>drawFocusIfNeeded()</a></li><li><a class=sidemenu-item href=drawimage.html title=drawImage>drawImage()</a></li><li><a class=sidemenu-item href=drawwidgetasonscreen.html title=drawWidgetAsOnScreen>drawWidgetAsOnScreen()</a></li><li><a class=sidemenu-item href=drawwindow.html title=drawWindow>drawWindow()</a></li><li><a class=sidemenu-item href=ellipse.html title=ellipse>ellipse()</a></li><li><a class=sidemenu-item href=fill.html title=fill>fill()</a></li><li><a class=sidemenu-item href=fillrect.html title=fillRect>fillRect()</a></li><li><a class=sidemenu-item href=filltext.html title=fillText>fillText()</a></li><li><a class=sidemenu-item href=getimagedata.html title=getImageData>getImageData()</a></li><li><a class=sidemenu-item href=getlinedash.html title=getLineDash>getLineDash()</a></li><li><a class=sidemenu-item href=ispointinpath.html title=isPointInPath>isPointInPath()</a></li><li><a class=sidemenu-item href=ispointinstroke.html title=isPointInStroke>isPointInStroke()</a></li><li><a class=sidemenu-item href=lineto.html title=lineTo>lineTo()</a></li><li><a class=sidemenu-item href=measuretext.html title=measureText>measureText()</a></li><li><a class=sidemenu-item href=moveto.html title=moveTo>moveTo()</a></li><li><a class=sidemenu-item href=putimagedata.html title=putImageData>putImageData()</a></li><li><a class=sidemenu-item href=quadraticcurveto.html title=quadraticCurveTo>quadraticCurveTo()</a></li><li><a class=sidemenu-item href=rect.html title=rect>rect()</a></li><li><a class=sidemenu-item href=removehitregion.html title=removeHitRegion>removeHitRegion()</a></li><li><a class=sidemenu-item href=resettransform.html title=resetTransform>resetTransform()</a></li><li><a class=sidemenu-item href=restore.html title=restore>restore()</a></li><li><a class=sidemenu-item href=rotate.html title=rotate>rotate()</a></li><li><a class=sidemenu-item href=save.html title=save>save()</a></li><li><a class=sidemenu-item href=scale.html title=scale>scale()</a></li><li><a class=sidemenu-item href=scrollpathintoview.html title=scrollPathIntoView>scrollPathIntoView()</a></li><li><a class=sidemenu-item href=setlinedash.html title=setLineDash>setLineDash()</a></li><li><a class=sidemenu-item href=settransform.html title=setTransform>setTransform()</a></li><li><a class=sidemenu-item href=stroke.html title=stroke>stroke()</a></li><li><a class=sidemenu-item href=strokerect.html title=strokeRect>strokeRect()</a></li><li><a class=sidemenu-item href=stroketext.html title=strokeText>strokeText()</a></li><li><a class=sidemenu-item href=transform.html title=transform>transform()</a></li><li><a class=sidemenu-item href=translate.html title=translate>translate()</a></li></ul></nav><script>function menuinit(){let i=document.getElementById("main_menubox"),n="sidemenu-arrdown",t="sidemenu-arrleft";i.querySelectorAll(".sidemenu-label").forEach(i=>{i.onclick=()=>{let r=i.parentNode.querySelector(`.${n},.${t}`);r.classList.contains(n)?(r.classList.remove(n),r.classList.add(t),i.parentNode.parentNode.classList.add("sidemenu-group-close")):(r.classList.add(n),r.classList.remove(t),i.parentNode.parentNode.classList.remove("sidemenu-group-close"))}})}function currentMenu(){let t=window.location.pathname,r=t.substr(t.lastIndexOf("/")+1),u="#main_menubox [href='"+r+"']",n=document.querySelector(u);n.classList.add("active");n.classList.add("bg-grayse");let i=document.querySelector("#main_menubox").parentElement;i.scrollTo(0,n.offsetTop-i.clientHeight/2)}menuinit();currentMenu()</script></div><div class="grid-10 pd-20"><h2>transform(a, b, c, d, e, f)</h2><p>使用矩阵多次叠加当前变换的方法,矩阵由方法的参数进行描述.你可以缩放,旋转,移动和倾斜上下文.</p>
<pre class="bg-gray pd-tb-10">
  ctx.transform(1, 0, 0, 1, 0, 0)
</pre><br /><h4>参数</h4><p><label class="label danger">a</label> <small>Number</small> 水平缩放 (m11)</p><p><label class="label danger">b</label> <small>Number</small> 水平倾斜 (m12)</p><p><label class="label danger">c</label> <small>Number</small> 垂直倾斜 (m21)</p><p><label class="label danger">d</label> <small>Number</small> 垂直缩放 (m22)</p><p><label class="label danger">e</label> <small>Number</small> 水平移动 (dx)</p><p><label class="label danger">f</label> <small>Number</small> 垂直移动 (dy)</p><br /><h4>测验</h4><p>可将画布看做矩阵,通过修改矩阵实现对绘画的缩放,旋转,移动,倾斜.</p><p>数学中的矩阵概念是m*n个数排列成m行n列,叫m x n矩阵.矩阵有矩阵运算,加,减,乘,转置等等</p><p>这个方法通过调整矩阵值来影响canvas绘画行为</p><p>参数对应矩阵如下.</p><canvas id=canvas1></canvas><p>a=2,水平缩放</p><p>本来是70*50的长方形,缩放后变成140*50.这个方法<a href=scale.html>scale()</a>能达到同样效果.</p><p>那为什么还要制作这个方法呢,因为此方法可以将几种变换做累加效果,如果只是需要其中一种变化效果,那调用相应方法就好</p><p>当需要做复杂变化时,用这个方法就非常实用.多种变换累加,能得到比较奇特的效果.前提是数学要好</p><canvas id=canvas2></canvas><p>b=Math.PI/6,水平倾斜30度</p><p>看起来这种水平倾斜好像是画布旋转了30度,但其实这误会了.这种变换是仿射变换,算法是矩阵乘法</p><p>可以这样认为,倾斜前,X,Y轴是互相垂直的,画出的矩形的四个角是都是直角.而水平倾斜30度之后,</p><p>x轴不在是水平的,而是有30度倾角,这样一来,就与y轴(不变)不再垂直.那么在这种坐标系内画出的矩形,</p><p>看起来是个平行四边形,事实上看就是平等四边形.可以认为坐标系扭曲了.</p><p>左边是正常方形,右边是水平倾斜后的样子.</p><canvas id=canvas3></canvas><p>c=Math.PI/6,垂直倾斜30度</p><p>同理,垂直倾斜可认为是y轴倾斜了30度,这种坐标系中画出来的矩形就成这种样子</p><p>左边是正常方形,右边是垂直倾斜后的样子.</p><canvas id=canvas4></canvas><p>d=2,垂直缩放</p><p>与水平缩放相似,垂直方向上变成了2倍</p><canvas id=canvas5></canvas><p>e=20,(dx)水平移动距离</p><p>水平移动的效果与<a href=translate.html>translate()</a>方法效果一样,改变了坐标原点</p><canvas id=canvas6></canvas><p>f=20,(dy)垂直移动距离</p><canvas id=canvas7></canvas><p>如果调用了此方法,修改了坐标系,那么后续的绘画都将在新坐标系内进行.如果要还原坐标系,最好在变化前调用<a href=save.html>save()</a></p><p>完成后调用<a href=restore.html>restore()</a>.画布默认参数值是(1, 0, 0, 1, 0, 0)</p><p>多次调用会有累加效果,如果不希望这种效果,可以尝试使用,<a href=settransform.html>setTransform()</a></p><p>先垂直倾斜30度,再垂直倾斜30度.可见右下的四边形比右上的要更扁</p><canvas id=canvas8></canvas><br /><script src=/asset/js/canvahelp.js></script><script>function test8(){let n=getCanvas2d("canvas8");n.moveTo(150,0);n.lineTo(150,150);n.stroke();n.fillRect(5,5,70,50);n.transform(1,0,Math.PI/6,1,150,0);n.fillRect(5,5,70,50);n.transform(1,0,Math.PI/6,1,0,70);n.fillRect(5,5,70,50)}function test7(){let n=getCanvas2d("canvas7");n.moveTo(150,0);n.lineTo(150,150);n.stroke();n.fillRect(5,5,70,50);n.save();n.translate(150,0);n.transform(1,0,0,1,0,50);n.fillRect(0,0,70,50);n.restore()}function test6(){let n=getCanvas2d("canvas6");n.moveTo(150,0);n.lineTo(150,150);n.stroke();n.fillRect(5,5,70,50);n.save();n.translate(150,0);n.transform(1,0,0,1,50,0);n.fillRect(0,0,70,50);n.restore()}function test5(){let n=getCanvas2d("canvas5");n.moveTo(150,0);n.lineTo(150,150);n.stroke();n.fillRect(5,5,70,50);n.save();n.translate(150,0);n.transform(1,0,0,2,0,0);n.fillRect(5,5,70,50);n.restore()}function test4(){let n=getCanvas2d("canvas4");n.moveTo(150,0);n.lineTo(150,150);n.stroke();n.fillRect(10,10,80,80);n.beginPath();n.moveTo(0,0);n.lineTo(140,0);n.moveTo(0,0);n.lineTo(0,140);n.strokeStyle="blue";n.stroke();n.font="18px serial";n.fillText("(x)",100,20);n.fillText("(y)",10,120);n.stroke();n.save();n.translate(150,0);n.transform(1,0,Math.PI/6,1,0,0);n.fillRect(10,10,80,80);n.moveTo(0,0);n.lineTo(150,0);n.moveTo(0,0);n.lineTo(0,150);n.strokeStyle="blue";n.stroke();n.font="18px serial";n.fillText("(x)",100,20);n.fillText("(y)",10,120);n.restore()}function test3(){let n=getCanvas2d("canvas3");n.moveTo(150,0);n.lineTo(150,150);n.stroke();n.fillRect(10,10,80,80);n.moveTo(0,0);n.lineTo(140,0);n.moveTo(0,0);n.lineTo(0,140);n.strokeStyle="blue";n.stroke();n.font="18px serial";n.fillText("(x)",100,20);n.fillText("(y)",10,120);n.stroke();n.save();n.beginPath();n.fillStyle="red";n.translate(150,0);n.transform(1,Math.PI/6,0,1,0,0);n.fillRect(10,10,80,80);n.moveTo(0,0);n.lineTo(150,0);n.moveTo(0,0);n.lineTo(0,150);n.strokeStyle="blue";n.stroke();n.font="18px serial";n.fillText("(x)",100,-10);n.fillText("(y)",10,120);n.restore()}function test2(){let n=getCanvas2d("canvas2");n.moveTo(150,0);n.lineTo(150,150);n.stroke();n.fillRect(5,5,70,50);n.save();n.translate(150,0);n.transform(2,0,0,1,0,0);n.fillRect(2.5,2.5,70,50);n.restore()}function test1(){let n=getCanvas2d("canvas1");n.moveTo(30,20);n.lineTo(30,130);n.moveTo(150,20);n.lineTo(150,130);n.stroke();n.font="28px serial";n.fillText("a",40,45);n.fillText("c",80,45);n.fillText("e",120,45);n.fillText("b",40,85);n.fillText("d",80,85);n.fillText("f",120,85);n.fillText("0",40,125);n.fillText("0",80,125);n.fillText("1",120,125)}test1();test2();test3();test4();test5();test6();test7();test8()</script></div></div></body></html>